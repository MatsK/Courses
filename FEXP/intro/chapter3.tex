\htitle{測定とデータの扱い方}
\expnum{\S3}
\makeatitle

\setcounter{section}{0}
\setcounter{equation}{0}
\setcounter{figure}{0}

\section{測定}\label{sec:ch3}

測定とはある物理的な量を基準と比較して数値で表す作業をいう。すなわち、そ
れぞれの物理量には、それを定量的に表す基準として単位が制定されており、そ
の物理量を単位の何倍であるという形に表現する。例えば、長さの基準として
1~[m]が定められており、ある物体の長さがその1.52倍であるとして1.52~[m]の
ように表す。

このような測定には、測定量とそれの基準量を直接比較して測る方法があり、
これを直接測定という。一方、物体の速度のように、ある時間幅とその間に移
動した距離を別々に測定し、それらの値から計算によって測定値を得る方法も
ある。これを間接測定という。もし、速度計によって速度を直接に測定するの
であれば、それは直接測定である。


\section{測定の誤差と精度}

一般に測定する物理量には {\bf{真の値}}(true value)が存在するが、通常、
測定によってはこの真の値を求めることはできない。何らかの原因によって測
定値は真の値から外れるものであり、測定値から真の値を引いたものを
{\bf{誤差}}(error)という。

同じ人間が同じ装置または器具を用いて測定を繰り返しても、測定値は同じにな
らず、ばらつく。この{\bf{ばらつき}}(dispersion)の度合いを{\bf {精
度}}(precision)ということで定性的に表し、ばらつきが少ない場合に精度が高
いというように表現する。こうしたばらつく測定値の平均と真の値との差を
{\bf{偏り}}(bias)といい、偏りの小ささを{\bf{正確度}} (accuracy)と
いう。精度が高い測定が必ずしも正確度が高いとは限らない。なお、こうした正
確度が「高い」という表現は偏りの数値と傾向が逆であることから、最近では正
確度に替えて「{\bf{不確かさ}}(uncertainty)」という表現を用い
るようになってきている。

誤差にはある明確な原因によって生じるものがあり、これを{\bf{系統的誤差}}
(systematic error)という。系統的誤差は偏りの原因となる。系統的誤差には測
定器の目盛の狂いや増幅器のゼロ点のずれなどの機械誤差、測定者個人の癖によ
る個人誤差、さらに測定値を計算する過程で起こる丸め誤差や桁落ち等の計算誤
差がある。これらの誤差は多くは原因が分かれば避けることができるし、また後
で補正することもできる。

原因が不明であるか、また原因が分かっていても偶然性を伴って生じる誤差もあ
り、これを{\bf{偶然誤差}}という。偶然誤差はばらつきの原因となる。これ
には測定者の不注意や過失によるものの他、どうしても避けることのできないも
のもある。後者を必然的偶然誤差という。

測定にあたっては、細心の注意を払って系統的誤差をなくすようにしなければな
らない。そのためには、まず、使用する機器の取扱説明書をよく読んで、そこに
指示されている注意を守り、機器を正しく操作することが大切である。すべての
測定器は少なくとも電源を入れて十分に時間をかけて熱的に安定するまで待って
使用することや、制限を超える値の入力を加えないことなどは常識である。また、
測定者の不注意や過失を完全に避けることはできないが、できるだけ注意を集中
し、複数の測定者による相互チェックなどを行えば、こうした誤差を最小にする
ことができる。

最後に残る必然的偶然誤差に関しては、以下の誤差論で理論的にその特徴が明ら
かにされている。測定値についての正しい処理法によりその影響を最小にするこ
とが大切である。

\section{間接測定における誤差}

目的とする量$Y$がそれぞれ直接測定で得られる物理量$x_1, x_2, \cdots, x_n$
の関数として
\begin{equation}
Y = F(x_1, x_2, \cdots, x_n)
\end{equation}
の形で与えられているとする。$x_1, x_2, \cdots, x_n$の直接測定における誤
差をそれぞれ $\delta x_1$, $\delta x_2, \cdots, \delta x_n$とすると、目
的量の誤差は
\begin{equation}
\delta Y = \sum_{i=1}^{n}{\partial F \over \partial x_i}\delta x_i
\end{equation}
となる({\bf 付録1})。ここで$\partial F/\partial x_i$は関数$F$の$x_i$に関
する偏微分係数である。誤差$\delta x_i$ $(i=1, 2, \cdots, n)$は正負両方の
値を取る可能性があるので、目的量の誤差の絶対値に対しては
\begin{equation}
|\delta Y|\leq\sum_{i=1}^{n}\left|{\partial F\over\partial x_i}\delta
 x_i\right|
\end{equation}
という不等式が成り立つ。または両辺を$Y$で割って
\begin{equation}
\left|{\delta Y \over Y}\right| \leq \sum_{i=1}^{n}\left|{\partial \ln F
\over \partial x_i}\delta x_i \right|
\end{equation}
となる({\bf 付録2})。なお、
\begin{math}
\ln x = \log_{\rm e} x
\end{math}
は自然対数である。ここで $\delta Y$を{\bf{絶対誤差}}、$\delta Y/Y$を
{\bf{相対誤差}}と呼ぶ。

具体的な例で説明すると、円柱の直径を$x_1$、高さを$x_2$とすると、その体積
は$Y=F(x_1, x_2)=(\pi/4)x_1^2x_2$なので
\begin{displaymath}
\delta Y = {\partial F \over \partial x_1}\delta x_1 + {\partial F \over
\partial x_2}\delta x_2 = {\pi \over 2}x_1x_2\delta x_1 + {\pi \over
4}x_1^2\delta x_2
\end{displaymath}
となる。

\subsection{例1}

ある長方形の板の縦と横の長さを測ったところ、縦204~[mm]、横356~[mm]であった。
誤差の絶対値は縦が0.8~[mm]以下、横が1.0~[mm]以下であるとする。面積を$Y$、
縦と横の長さをそれぞれ$x_1$、$x_2$とすると、$F=x_1x_2$であることから
\begin{displaymath}
|\delta Y| \leq \left|{\partial F \over \partial x_1}\delta x_1\right| +
\left|{\partial F \over \partial x_2}\delta x_2\right| = |x_2 \delta
x_1| + |x_1 \delta x_2|
\end{displaymath}
となり、$|\delta Y|\leq 488.8$~[mm$^2$]という値が得られる。後述するように、
誤差は通常1桁とするので、$|\delta Y|\leq 5\times 10^2$~[mm$^2$] となる。


\subsection{例2}

$A$を定数、$x_i(i=1, 2, \cdots, n)$を変数とし、
$Y=Ax_1^{m_1}x_2^{m_2}\cdots x_n^{m_n}$で与えられる量の相対誤差を考える。
(3)式より
\begin{displaymath}
|\delta Y| \leq |Am_1 x_1^{m_1-1}x_2^{m_2}\cdots x_n^{m_n}\delta x_1| +
 |Am_2 x_1^{m_1}x_2^{m_2-1}\cdots x_n^{m_n}\delta x_2|
\end{displaymath}
\begin{displaymath}
 \hspace{3cm} + \cdots + |Am_n x_1^{m_1}x_2^{m_2}\cdots
 x_n^{m_n-1}\delta x_n|
\end{displaymath}
となる。したがって、これを$|Y|$で割って
\begin{displaymath}
\left|{\delta Y \over Y}\right| \leq \left|{Am_1
x_1^{m_1-1}x_2^{m_2}\cdots x_n^{m_n}\over Ax_1^{m_1}x_2^{m_2}\cdots
x_n^{m_n}}\delta x_1\right| + \left|{Am_2 x_1^{m_1}x_2^{m_2-1}\cdots
x_n^{m_n}\over Ax_1^{m_1}x_2^{m_2}\cdots x_n^{m_n}}\delta x_2\right|
\end{displaymath}
\begin{displaymath}
 \hspace{3cm} + \cdots + \left|{Am_n x_1^{m_1}x_2^{m_2}\cdots
 x_n^{m_n-1}\over Ax_1^{m_1}x_2^{m_2}\cdots x_n^{m_n}}\delta x_n\right|
\end{displaymath}
\begin{displaymath}
\hspace{-2.6cm} = \left|m_1{\delta x_1\over x_1}\right| +
\left|m_2{\delta x_2\over x_2}\right| + \cdots + \left|m_n{\delta
x_n\over x_n}\right|
\end{displaymath}
となる。なお、この結果は(4)式からも得られる。すなわち、両辺の対数をとると
\begin{displaymath}
\ln Y = \ln A + m_1\ln x_1 + m_2\ln x_2 + \cdots + m_n\ln x_n
\end{displaymath}
となるが、
\begin{displaymath}
{\partial \ln Y \over \partial x_i} = {m_i \over x_i}
\end{displaymath}
の関係があるので($i=1, 2, \cdots, n$)、上と同じ結果が得られる。

\subsection{例3}

円柱の重心を通り、円柱軸に垂直な軸の回りの慣性モーメントは、円柱の質量
$M$、直径$d$、長さ$l$を用いて
\begin{displaymath}
Y = M\left({l^2\over 12} + {d^2\over 16}\right)
\end{displaymath}
で与えられる。$M$、$d$、$l$の誤差をそれぞれ$\delta M$、$\delta d$、
$\delta l$とすると
\begin{displaymath}
\delta Y = \left({l^2\over 12} + {d^2\over 16}\right)\delta M + {Ml\over
6}\delta l + {Md\over 8}\delta d
\end{displaymath}
なので
\begin{displaymath}
{\delta Y \over Y} = {\delta M \over M} + {8 \over 4 +
(3d^2/l^2)}\cdot{\delta l\over l} + {6 \over 3 + (4l^2/d^2)}\cdot{\delta
d\over d}
\end{displaymath}
となる。$l\simeq 100$~[mm]、$d\simeq 10$~[mm]のとき
\begin{displaymath}
{\delta Y \over Y} \simeq {\delta M \over M} + 1.985{\delta l\over l} +
0.015{\delta d\over d}
\end{displaymath}
となる。したがって、直径$d$の測定誤差による慣性モーメントの誤差は長さ$l$
の測定誤差によるものに比べて極めて小さいことがわかる。$l$の相対誤差を
0.1\%で測定するとき、その影響は0.2\%程度であり、したがって$d$の相対誤差
を10\%以下で精度よく測定してもあまり意味がないことになる。このように、間
接測定の場合、量によって測定精度を選ぶべきである。

\section{誤差の取り扱い}

\subsection{誤差の表記}

実験で得られる値(測定値)には必ず誤差が含まれる。例えば、測定値は$1956
\pm 4$~[mm]のような形で表される。この例では、1956~[mm]は真の値に最も
近いと推定される値であり、これを{\bf{最確値}}(most probable value)という。
また$\pm 4$~[mm]は推定された最確値の信頼度の範囲を表し、誤差の範囲とい
う。つまり、真の値が1952~[mm]と1960~[mm]の間にある確率が高いことを示し
ている。

\subsection{有効数字}

以上のように測定値を数値で表すにあたって、例えば156~[mm]が156.000~[mm]
を意味するのではないということに注意しなければならない。今の場合、小数点
以下2 桁目の数値が明確ではないことを意味する。このように測定量を表すにあ
たって、位取りのための0を除いた、意味のある数値を{\bf{有効数字}}という。
156.0~[mm]のように書かれた場合には、最後の0は意味をもち、その長さは
155.95~[mm]から156.05~[mm]の間にあることを示している。

このようなことから、有効数字が3桁の場合は165000のようには書かず、
$1.65\times 10^5$のように書く。また、0.00165の場合は$1.65\times 10^{-3}$
のように書くのが普通である。

測定量を最確値と誤差の範囲で表すときにも有効数字に注意しなければならない。
例えば、重力加速度を測定して
\begin{displaymath}
g = 9.821 \pm 0.02385~[\rm m/s^2]
\end{displaymath}
のように書くのは適切でない。基礎実験では誤差は有効数字1桁にまとめること
にし
\begin{displaymath}
g = 9.82 \pm 0.02~[\rm m/s^2]
\end{displaymath}
のように書くことを原則とする。また、有効桁の最小値および誤差の値が10の桁
以上の場合、次のように記述する。
\begin{displaymath}
g = (982 \pm 2) \times 10~[\rm mm/s^2]
\end{displaymath}

\subsection{測定値の四則演算}

2個以上の測定値の加減は最後の桁の数字に注意しなければならない。例えば
$x_1 = 23.44$~[mm]、$x_2 = 15.7$~[mm]のとき
\begin{displaymath}
x_1 + x_2 = 23.4~[\rm mm] + 15.7~[\rm mm] = 39.1~[\rm mm]
\end{displaymath}
とする。これは小数点以下2桁目に誤差が含まれるからである。

次に、目的量が2つの直接則定量$x_1$と$x_2$の積、$Y=x_1x_2$で与えられる場
合を考える。$x_1=1.78$、$x_2=2.7$の場合、直接代入して$Y=4.806$とするので
はなく、$x_2$の有効数字が2桁であることから、$Y$の有効数字も2桁し
かなく、$Y=4.8$とするのが妥当である。以下、このことを証明してみよう。こ
れらの有効数字は四捨五入で得られていることから、実際は
\begin{displaymath}
x_1=1.78+0.00y, \hspace{1cm} x_2=2.7+0.0y
\end{displaymath}
であり、$y$は$-5<y<5$の数字である。$x_2$の最後の桁の$0.0y$を$x_1$に掛け
た値は$0.0y$と見なされ、次に、$x_2$の中の桁の0.7を$x_1$に掛けた値は
$1.246y$と見なされる。そして、$x_2$の一番上の桁の2を$x_1$に掛けた値は
$3.56y$と見なされる。これらを以下のように加えると

\bigskip
\begin{center}

\begin{tabular}{l}
\phantom{+)} $0.0 y$  \\
\phantom{+)} $1.246 y$  \\
+) 3.56{\it y}  \\  \hline
\phantom{+)} 4.8{\it y}
\end{tabular}

\end{center}

\bigskip

\noindent
となる。ここで、具体的に数値で示された部分は確かなものであり、小数点下
2桁目の4と6は合計して10となり、すぐ上の桁に繰り上げられている。こうし
て小数点下2桁目に不確かさが入ることが分かり、有効数字を2桁としたことが
正しいことが示される。

以上のように、精度は、直接測定量の加減算では最も高い位の不確定さで決ま
り、積や商では最も精度の悪い測定量によって決まる。

\subsection{丸め誤差と桁落ち}

一つの数値をある桁で四捨五入することを丸めるという。例えば、24.1と24.7 
を2桁の数字に丸めると、それぞれ24と25になる。{\bf{丸め誤差}}とは丸めるこ
とにより生じる誤差で、「丸
めて計算した値」から「丸める前の値」を引いた値で定義される。

また、同程度の値の引き算があるとき、有効数字の桁数が少なくなる事があり、これ
を{\bf{桁落ち}}という。桁落ちによって計算結果が誤差に埋もれてしまい、
意味をなさなくなることがある。

\section{データの表し方}

低温における金属の比熱は温度$T$に対して
\begin{displaymath}
C = \gamma T + AT^3
\end{displaymath}
のように変わる。ここで、第1項は電子による寄与で、$\gamma$を電子比熱係数
という。また、第2項は結晶格子による寄与である。ここで、比熱$C$を温度$T$ 
で割り、これを 温度の二乗$T^2$に対して図示すると、図~\ref{fig1}のように
なる。すなわち、$y=C/T$、$x=T^2$とすると、上の関係式は
\begin{equation}
y = \gamma + Ax
\end{equation}
のような直線となり、図の$y$切片から$\gamma$が、直線の傾きから係数$A$が求
まる。このように図に適切に示すことにより、$\gamma$や$A$などの目的量を簡
単に求めることができる。

\begin{figure}
\begin{center}
\includegraphics[scale=1.0]{fig1.eps}
%\epsfile{file=fig1.eps,height=8cm}
\caption{(5)式の関係}
\label{fig1}
\end{center}
\end{figure}

\begin{figure}
\bigskip
\begin{center}
\includegraphics[scale=0.9]{fig2.eps}
%\epsfile{file=fig2.eps,height=8cm} 
\caption{(6)式の関係。ただし, aは
$a=1/2$, $n=3$の場合, bは$a=2$, $n=1/3$の場合} \label{fig2}
\end{center}
\end{figure}

次に、物理量$Y$が変数$X$によって
\begin{equation}
Y = aX^n
\end{equation}
のように変化する場合、その変化を確認し、特徴を表す係数$a$と$n$を適切に求
めるためにはどのようにすればよいであろうか。もし、通常のグラフに描いたの
では図~\ref{fig2} のようになり、(6)式に従っていることの確認も、係数$a$と
$n$を求めることも容易ではない。このような巾(べき)関数の場合には両対数グ
ラフを用いるとよい。すなわち

\begin{displaymath}
y = \log Y, \hspace{1cm} x = \log X
\end{displaymath}
と置けば、(6)式の関係は
\begin{equation}
y = C + nx
\end{equation}
となり、(5)式の場合と同様になる。ここで$C=\log a$である。すなわち、この
ような両対数に示せば、それが直線になることより巾関数であることが確かめら
れ、勾配から$n$が、切片から$C$または$a$が直ちに求まる。例を図~\ref{fig3} 
に示す。
\begin{figure}
\begin{center}
\includegraphics[scale=0.9]{fig3.eps}
%\epsfile{file=fig3.eps,height=8cm}
\caption{図~2 の結果を両対数グラフで示したもの}
\label{fig3}
\end{center}
\end{figure}

薄い絶縁物などの障壁をトンネルして流れる電流$I$は
\begin{equation}
I = G \exp\left(-{U\over kT}\right)
\end{equation}
\begin{figure}
\begin{center}
\includegraphics[scale=0.9]{fig4.eps}
%\epsfile{file=fig4.eps,height=8cm}
\caption{(8)式の関係。ただし、$G=15$、$U/k=70$の場合}
\label{fig4}
\end{center}
\end{figure}
のように温度$T$によって変化する(図~\ref{fig4} 参照)。ここで$U$はエネルギー
障壁の高さ、$k$はボルツマン定数であり、$G$は電子密度などで決まる係数であ
る。この場合は通常の方眼紙や両対数グラフに描いても簡単な形にはならない。
この場合は
\begin{displaymath}
y = \log I, \hspace{1cm} x = T^{-1}
\end{displaymath}
と置けば、同様に
\begin{equation}
y = C' - bx
\end{equation}
の形になる。ここで$C' = \log G$、$b = U/k$である。したがって、図
\ref{fig5} のように片対数グラフにプロットして直線となることにより、指数
関数であることが確かめられ、定数の$G$と$U$が求まる。
\begin{figure}
\begin{center}
\includegraphics[scale=0.63]{fig5_1.eps}
%\epsfile{file=fig5.eps,height=8cm}
\caption{図~4 の関係を片対数グラフで示したもの}
\label{fig5}
\end{center}
\end{figure}


\section{誤差の法則}

\subsection{正規分布}

ここでは偶然誤差の分布を考えよう。一般に偶然誤差は多数の原因から生じる微
小な誤差が集積したものであるが、ここでは話を簡単にするため、4つの独立な
原因があり、それぞれが$+\epsilon$または$-\epsilon$の誤差をもたらすものと
し、正負の誤差をもたらす確率が等しく1/2であるとする。その結果、全体とし
ての誤差が$-4\epsilon$から$4\epsilon$までの16通りの場合があり、その場合
の数は

\bigskip

\begin{center}

\begin{tabular}{ccccc}
$-4\epsilon$ & $-2\epsilon$ & ~0~ & $+2\epsilon$ & $+4\epsilon$ \\
 \hline 1 & 4 & 6 & 4 & 1
\end{tabular}

\end{center}

\bigskip

\noindent となり、絶対値が小さい集積誤差が生じる機会が多いことがわかる。
これは簡単な二項分布となるが、原因の数が無数に多く、一つ一つの原因から生
じる誤差が無限に小さい極限では、大きさが$x$と$x+{\rm d}x$の間にある誤差
が生じる確率は
\begin{equation}
p(x) = {1\over \sqrt{2\pi}\sigma}\exp\left(-{x^2 \over 2\sigma^2}\right)
\end{equation}
で与えられる。この確率分布を{\bf{正規分布}}(normal distribution)また
は{\bf{ガウス分布}}(Gaussian distribution)といい、誤差分布が(10) 式に
従うことをガウスの誤差法則という。前の係数
\begin{math}
1/\sqrt{2\pi}\sigma
\end{math}
は全確率が1であるという規格化条件
\begin{equation}
\int_{-\infty}^{\infty}p(x){\rm d}x = 1
\end{equation}
から決まる({\bf 付録3})。いろいろな$\sigma$の値の場合の正規確率分布関数
$p(x)$ を図~\ref{fig6} に示す。この図から分かるように、定数$\sigma$が小
さくなるほど、分布はシャープになる。この$\sigma$を{\bf{標準偏差}}
(standard deviation)という。誤差が$|x|\leq \sigma$となる確率は
\begin{displaymath}
\int_{-\sigma}^{\sigma}p(x){\rm d}x = 0.6827
\end{displaymath}
であり、誤差が$|x|\leq 3\sigma$となる確率は
\begin{displaymath}
\int_{-3\sigma}^{3\sigma}p(x){\rm d}x = 0.9973
\end{displaymath}
となる。

\begin{figure}[t]
\begin{center}
\includegraphics[scale=0.9]{fig6.eps}
%\epsfile{file=fig6.eps,height=8cm}
\caption{$\sigma = 0.5$、1.0の場合の正規分布}
\label{fig6}
\end{center}
\end{figure}

標準偏差$\sigma$の代りに
\begin{equation}
\int_{-\epsilon}^{\epsilon}p(x){\rm d}x = {1\over 2}
\end{equation}
となるような$\epsilon$が定義され、これを{\bf{確率誤差}}(probability
error)という。数値計算より
\begin{equation}
\epsilon = 0.6745\sigma
\end{equation}
の関係が得られる。この確率誤差は生じる誤差が$\pm \epsilon$の間にある確
率が50\%となることを示している。

以下、ガウスの誤差法則に従う場合の特徴を調べてみよう。まず、ある量(真
の値を$Z$とする)を$n$回測定して測定値$M_i(i=1, 2, \cdots, n)$を得たと
する。するとそれぞれの誤差は$x_i = M_i-Z(i=1, 2, \cdots, n)$となる。し
たがって、これらの誤差が同時に起こる確率は
\begin{equation}
P (x_1, x_2, \cdots, x_n) = \prod_{i=1}^{n}p(x_i)
 = \left({1\over \sqrt{2\pi}\sigma}\right)^n \exp\left[-{1\over 2\sigma^2}
    \sum_{i=1}^n(M_i - Z)^2\right]
\end{equation}
で与えられる。したがって、$Z$の最も確からしい値、すなわち{\bf{最確値}}
  $Z_{\rm m}$はこの$P$を最大にする、すなわち
\begin{equation}
\sum_{i=1}^n(M_i - Z)^2
\end{equation}
を最小にする$Z$の値と考えることができる。これより、(15)式を$Z$で微分し
て0と置き
\begin{equation}
Z_{\rm m} = {1\over n}\sum_{i=1}^n M_i
\end{equation}
を得る。すなわち、最確値は測定値の算術平均で与えられる。

\subsection{各量の関係}

1回の測定の結果は無数にある仮想的な測定結果の集合(これを{\bf{母集団}} と
いう)から1つの要素(試料)を選択する作業であると見なせる。こうした母集団の
平均値を{\bf{母平均}}(population mean)という。複数回測定を行った場合は、
母集団からその数の試料をランダムに抽出したものと考える。こうした有限回数
の測定結果の平均値を{\bf{試料平均}}(sample mean)といい、最確値に等しい。

母集団の最確値が$a$である場合の正規分布関数は、容易に示せるように(10)式
を用いて$p(x-a)$で与えられる。その平均値は
\begin{equation}
\langle x \rangle = \int_{-\infty}^{\infty} xp(x-a){\rm  
d}x = a
\end{equation}
である。

図~\ref{fig7} に上で述べた各量の相対的な関係を示す。測定値と真の値との差
がすでに述べた誤差であるが、これは未知である。測定値と母平均の差を{\bf
{偏差}}(deviation)、測定値と試料平均の差を{\bf{残差}}(residual)という。
なお、この図から明らかなように、正しくは正規分布に従うのは誤差でなく、偏
差である。

\begin{figure}
\begin{center}
\includegraphics[scale=0.9]{fig71.eps}
%\epsfile{file=fig71.eps,height=8cm}
\caption{母集団の分布と各量の間の関係} \label{fig7}
\end{center}
\end{figure} 

次に、測定の精度に関係して、そのばらつきの程度を表すものとして偏差の二乗
平均を求めてみよう。母平均を$a$とすると、測定値$M$に対して偏差は$M-a$で
与えられ、その2乗平均は
\begin{equation}
  \int_{-\infty}^{\infty}(M-a)^2 p(M-a){\rm d}M = {1\over
    \sqrt{2\pi}\sigma}\int_{-\infty}^{\infty}(M-a)^2
  \exp\left[-{(M-a)^2 \over 2\sigma^2}\right]{\rm d}M = \sigma^2
\end{equation}
となり({\bf 付録4})、これを{\bf{母分散}}(population variance)という。す
なわち、母分散は標準偏差の2乗に等しい。測定結果の残差からこの母分散に対
応した{\bf 試料分散}
\begin{equation}
\sigma_{\rm s}^2 = {1\over n}\sum_{i=1}^n (M_i - Z_{\rm  
m})^2
\end{equation}
を定義する。また、試料平均の標準偏差を推定することができ、それは
\begin{equation}
  \sigma_{\rm m} = \left[{1\over n(n-1)}\sum_{i=1}^{n}(M_i - Z_{\rm
      m})^2\right]^{1/2}={1\over (n-1)^{1/2}}\sigma_{\rm s}
\end{equation}
で与えられる({\bf 付録5})。

\subsection{最確値と誤差伝播の法則}

(1)式で仮定したように、目的量$Y$が直接測定で得られる物理量$x_1, x_2,
\cdots, x_n$の関数として
\begin{displaymath}
Y = F(x_1, x_2, \cdots, x_n)
\end{displaymath}
で与えられるとする。直接則定量$x_1, x_2, \cdots, x_n$の最確値$Z_{1{\rm
    m}}, Z_{2{\rm m}}, \cdots, Z_{n{\rm m}}$が求まっているとき、$Y$の
最確値$Y_{\rm m}$と標準偏差$\sigma$はそれぞれ
\begin{equation}
Y_{\rm m} = F(Z_{1{\rm m}}, Z_{2{\rm m}}, \cdots, Z_{n{\rm m}})
\end{equation}
\begin{equation}
\sigma^2 = \sum_{i=1}^n\left({\partial F \over \partial x_i}\right)^2
\sigma_{i}^2
\end{equation}
で与えられる({\bf 付録6})。(21)式の結果を{\bf{誤差伝播の法則}}といい、測
定は右辺の各項の値がほぼ等しくなるように行うべきである。

\subsection*{[例]}

単振子の振動によって重力加速度$g$の測定を行うとき、紐の長さを$L$、振動
周期を $T$とすると
\begin{displaymath}
g = {4\pi^2 L \over T^2} = F(L, T)
\end{displaymath}
である。この場合、(21)式の誤差伝播の法則は
\begin{displaymath}
\sigma_g^2 = \left({\partial F\over \partial L}\right)^2 \sigma_{L}^2
    + \left({\partial F\over \partial T}\right)^2 \sigma_{T}^2
\end{displaymath}
となる。$g$、$L$、$T$にそれぞれの最確値$g_{\rm m}$、$L_{\rm m}$、
$T_{\rm m}$を代入して整理すると
\begin{displaymath}
  \left({\sigma_{g}\over g_{\rm m}}\right)^2 = \left({\sigma_{L}\over
      L_{\rm m}}\right)^2 + 4\left({\sigma_{T}\over T_{\rm
        m}}\right)^2
\end{displaymath}
となる。紐の長さよりも振動周期の方をより正確に測定する必要があることが知
れる。


\section{最小二乗法}

ある物理量$P$がある量$x$と$y$の関数として
\begin{equation}
P = ax + by
\end{equation}
で与えられる場合に、$(x, y, P)$の組の測定を繰り返して、その結果から係数
$a$と$b$の最確値を求めることを考える。その測定値の組を$(x_i, y_i,
P_i)(i=1, 2, \cdots, n)$とする。このとき
\begin{equation}
P_i = ax_i + by_i; \hspace{0.5cm} i=1, 2, \cdots, n
\end{equation}
の関係(これらを{\bf{観測方程式}}という)が期待されるが、$n \geq 3$の場合
にはこれらを全て満たす$a$と$b$の解は存在しない。したがって、それらの最確
値を用いた場合、それぞれの測定値の組に対して
\begin{equation}
P_i - ax_i - by_i = r_i; \hspace{0.5cm} i=1, 2, \cdots, n
\end{equation}
のようになり、これを{\bf{誤差方程式}}という。$a$と$b$の最確値は
\begin{equation}
S = \sum_{i=1}^n r_i^2
\end{equation}
を最小とするように決まる。したがって
\begin{equation}
\sum_{i=1}^n r_i{\partial r_i \over \partial a} = 0
\end{equation}
\begin{equation}
\sum_{i=1}^n r_i{\partial r_i \over \partial b} = 0
\end{equation}
より、具体的に
\begin{equation}
[xx]a + [xy]b = [xP]
\end{equation}
\begin{equation}
[xy]a + [yy]b = [yP]
\end{equation}
となる。これを{\bf{正規方程式}}という。ただし
\begin{displaymath}
[xy] = \sum_{i=1}^n x_i y_i
\end{displaymath}
のような記号を用いた。これは容易に解くことができ
\begin{equation}
a = {[yy][xP] - [xy][yP] \over [xx][yy]-[xy]^2}
\end{equation}
\begin{equation}
b = {[xy][xP] - [xx][yP] \over [xy]^2-[xx][yy]}
\end{equation}
を得る。このように係数$a$、$b$の最確値を求める方法を{\bf{最小二乗法}}と
いう。

\newpage

\section*{\S 参考書}

\begin{itemize}

\item[1)]一瀬~正巳: 「誤差論」(倍風館)

\item[2)]中村~清二: 「物理実験」(岩波全書)

\item[3)]小田~幸康、大石~和男: 「物理実験入門」(裳華房)

\item[4)]吉田~功: 「測定値の統計的処理」(電気学会)

\item[5)]岡田~恭栄: 「多変数の統計」(共立出版)

\item[6)]J. R. Tylor: "An Introduction to Error Analysis" (Oxford
Univ. Press, 1982)

\item[7)]眞島~正市、磯部~孝: 「計測法通論」(東京大学出版界)

\end{itemize}



\section*{\S 付録}

\subsection*{付録1}

簡単のため、物理量$x_1$の誤差による影響のみを取り扱うことにする。$x_1$が
真の値 $a$をとるときの$Y$の値を$F(a)$とすると、$x_1$が微少量変化して
$a+\delta x_1$になったときの$Y$の値は$\delta x_1$の1次のオーダーまでで
\begin{displaymath}
Y = F(a) + \left({\partial F \over \partial x_1}\right)_{x_1=a}\delta x_1
\end{displaymath}
となる。同様にして他の物理量が真の値から変化したときの$Y$の値も求まり、
それらを総合して(2)式が導かれる。

\subsection*{付録2}

(2)式を$|Y|$で割ると
\begin{displaymath}
{\delta Y\over Y} = \sum_{i=1}^{n}{1\over F}\cdot {\partial F \over
\partial x_i} \delta x_i
\end{displaymath}
となるが、容易に示せるように
\begin{displaymath}
{\partial \ln F \over \partial x_i} = {1\over F}\cdot {\partial F \over
\partial x_i}
\end{displaymath}
である。これから(4)式が導かれる。

\subsection*{付録3}

ここで(11)式を2乗した値を計算してみよう。この値は
\begin{displaymath}
K = \left[\int_{-\infty}^{\infty}p(x){\rm d}x\right]^2
  = {1\over 2\pi \sigma^2} \int_{-\infty}^{\infty}{\rm d}x
    \int_{-\infty}^{\infty}{\rm d}y \exp\left[-{(x^2+y^2)
           \over 2\sigma^2}\right]
\end{displaymath}
と変形できる。ここで$x^2+y^2=r^2$として直角座標系から2次元極座標系に変換
すると、上式は
\begin{displaymath}
K = {1\over 2\pi \sigma^2} \int_{0}^{\infty} \exp\left(-{r^2 \over
        2\sigma^2}\right) 2\pi r{\rm d}r = {1\over
        \sigma^2}\left[-\sigma^2 \exp\left(-{r^2 \over 2\sigma^2}\right)
        \right]_{0}^{\infty} = 1
\end{displaymath}
となる。よって(11)式が証明される。

\subsection*{付録4}

まず、この積分の値は$a=0$としても同じである。したがって、(18)式は部分積
分して
\begin{displaymath}
\hspace{-8cm}{1\over \sqrt{2\pi}\sigma}\int_{-\infty}^{\infty}x^2
\exp\left(-{x^2 \over 2\sigma^2}\right){\rm d}x
\end{displaymath}
\begin{displaymath}
 = {1\over \sqrt{2\pi}\sigma}\left[-\sigma^2 x \exp\left(-{x^2 \over
 2\sigma^2}\right)\right]_{-\infty}^{\infty} + {\sigma \over
 \sqrt{2\pi}}\int_{-\infty}^{\infty} \exp\left(-{x^2 \over
 2\sigma^2}\right){\rm d}x
\end{displaymath}
となるが、右辺第1項は0であり、第2項の積分は(6)式より$\sqrt{2\pi}\sigma$ 
を与える。よって(18)式が証明された。

\subsection*{付録5}

{\bf 6}で述べたように、測定という作業は無数にある母集団から1つの結果を選
択するということと見なせる。したがって、同じ測定を$n$回繰り返して測定し
たときの結果の期待値は、母集団の中から$n$個を選ぶという試みを多数回行っ
たときの平均で与えられると考えられる。ここで$n$回の測定を1組とし、$m$組
の測定を行ったとする。その$k$組目($k=1, 2, \cdots, m$)における$i$回目の
測定($i=1, 2, \cdots, n$)の誤差を$\delta_{ki}$と表す。このとき$k$組目に
おける最確値(試料平均)の誤差は
\begin{displaymath}
\delta_k = {1\over n}\sum_{i=1}^{n} \delta_{ki}
\end{displaymath}
であり、最確値の二乗平均誤差は
\begin{displaymath}
\sigma_{\rm m}^2 = {1\over m}\sum_{k=1}^m \delta_k^2
\end{displaymath}
で与えられると考えられる。ここで
\begin{displaymath}
\delta_k^2 = {1\over n^2}\sum_{i}\delta_{ki}^2 + {1\over n^2}\sum_{i
    \neq j}\delta_{ki}\delta_{kj}
\end{displaymath}
と書ける。ただし、第2項は$i \neq j$であるように$i$と$j$について和をとっ
たものである。誤差$\delta_{ki}$が正規分布に従うとすると、それらが正負の
値をとる確率は等しいことから、この第2項は0になると期待される。したがって
\begin{displaymath}
\sigma_{\rm m}^2 = {1\over mn^2}\sum_{k=1}^m \sum_{i=1}^n \delta_{ki}^2
= {1\over mn^2}mn\sigma^2 = {\sigma^2 \over n}
\end{displaymath}
となる。途中、1組における測定の二乗誤差の期待値が$\sigma^2$であることを用
いた。すなわち、当然であるが、試料平均についての分布はばらつきが小さくな
る。

次に、残差の二乗平均を求めてみよう。残差は
\begin{displaymath}
\rho_i = M_i - Z_{\rm m}
\end{displaymath}
であり、$Z_{\rm m} - Z = \delta$とすると、
\begin{displaymath}
\delta_i = M_i - Z = \rho_i + \delta
\end{displaymath}
となる。よって
\begin{displaymath}
\sum_{i=1}^n \delta_i^2 = \sum_{i=1}^n \rho_i^2 + 2\delta \sum_{i=1}^n
\rho_i + n\delta^2
\end{displaymath}
であるが、左辺は$n\sigma^2$であり、右辺の第2項の和はほぼ0になると期待さ
れる。また$\delta^2$は測定を多数回行ったときの平均値$\sigma_{\rm
m}^2=\sigma^2/n$と見てよい。これから
\begin{displaymath}
n\sigma^2 = \sum_{i=1}^n \rho_i^2 + \sigma^2
\end{displaymath}
となる。すなわち
\begin{equation}
\sigma = \left({1\over n-1}\sum_{i=1}^n \rho_i^2\right)^{1/2}
\end{equation}
となり、有限回数の測定の残差から母集団の分布の標準偏差が推定できる。また、
この結果から(20)式が導かれ、得られた試料平均の確からしさが推定できる。


\subsection*{付録6}

(2)式より
\begin{displaymath}
\delta Y^2 = \sum_{i} \left({\partial F \over \partial x_i}\right)^2
\delta x_{i}^2 + \sum_{i \neq j} {\partial F \over \partial x_i}\cdot
{\partial F \over \partial x_j}\delta x_i \delta x_j
\end{displaymath}
となる。第2項は$i \neq j$であるように$i$と$j$について和をとったものであ
る。それぞれの$x_i$について、多くの測定値$x_{ik}(k=1, 2, \cdots, m)$をとっ
たとし、それらの誤差に対する上式を辺々加算すれば
\begin{displaymath}
\sum_{k}\delta Y_{k}^2=\sum_{i}\sum_{k}\left({\partial F \over \partial
x_{ik}}\right)^2 \delta x_{ik}^2 +\sum_{i \neq j}\sum_{k}{\partial
F\over\partial x_{ik}}\cdot{\partial F\over\partial x_{jk}}\delta
x_{ik}\delta x_{jk}
\end{displaymath}
となる。この右辺第2項はほぼ
\begin{displaymath}
 \left({\partial F \over \partial x_{i}}\right)_{\rm m} \left({\partial
F \over \partial x_{j}}\right)_{\rm m} \sum_{i \neq j} \sum_{k}\delta
x_{ik} \delta x_{jk}
\end{displaymath}
と書けるが、誤差が正負の値をとる確率は等しく、$k$についての和がほぼ0とな
る。よって、上式を$m$で割って
\begin{displaymath}
\delta Y^2=\sum_{i}\left({\partial F\over\partial x_i}\right)^2\delta
x_{i}^2
\end{displaymath}
となる。したがって
\begin{displaymath}
\sigma^2 = \sum_{i=1}^n\left({\partial F \over \partial x_i}\right)^2
\sigma_{i}^2
\end{displaymath}
となり、(22)式が得られる。


\newpage


\section*{\S 問題}

\bigskip
\noindent {\bf [問題1]}~
(17)式を導け。(ヒント: $zp(z)$は奇関数なので
\begin{displaymath}
\int_{-\infty}^{\infty} zp(z){\rm d}z = 0
\end{displaymath}
となることを用いよ。)

\bigskip

\noindent {\bf [問題2]}~
銅線に電流$I$を流し、電圧$V$を測
定してこの銅線の電気抵抗$R$を求めようとした。このとき熱起電力$V_0$のため、電圧は
$V=RI+V_0$となる。流した電流を$I_i$、測定した電圧を$V_i(i=1, 2, \cdots,
n)$として、最小二乗法により$R$と$V_0$を求める式を導け。


\bigskip

\noindent {\bf [問題3]}~長方形板の寸法が縦400.0~[mm]、横500.0~[mm]、厚さ
10.0~[mm]であり、誤差が縦$\pm$0.5~[mm]、横$\pm$0.6~[mm]、厚さ
$\pm$0.1~[mm]であるとする。この板の体積の相対誤差を求めよ 。

\bigskip

\noindent {\bf [問題4]}~銅線の電気抵抗を測定して銅の比抵抗を求める。銅線
の直径を$D$、長さを$L$、電流を$I$、電位差を$V$とすれば、比抵抗は
\begin{displaymath}
\rho_{\rm r} = {\pi VD^2 \over 4IL}
\end{displaymath}
となる。$\rho_{\rm r}$の相対誤差を求め、銅線の直径を他の量より高い精度
で測定しなければいけない理由を考えよ。

\bigskip

\noindent {\bf [問題5]}~$x_1=200.01$、$x_2=1000$、$x_3=0.19994$のとき、
$Y=x_1 - x_2x_3$を以下の方針に沿って計算せよ。ただし、$x_1$と$x_3$は測定
値、$x_2$は確定値とする。

\begin{itemize}

\item[(1)]丸めないで

\item[(2)]4桁に丸めて

\item[(3)]3桁に丸めて

\end{itemize}


\noindent {\bf [問題6]}~数値はすべて測定値で、有効数字を表しているとして、
次式を計算せよ。計算は筆算で行い、途中の計算結果も明示すること。

\bigskip

(1) $152.3 + 6.478$  \hspace{1cm} (2) $58.36 \times 8.254$  
\hspace{1cm} (3) $8.472 \div 22.63$

\bigskip

\noindent {\bf [問題7]}~針金の直径を測って下表のようなデータを得た。最確
値を求め、残差から{\bf 付録5}の(33)式を用いて母集団の標準偏差を推定し、
確率誤差を求めよ。また、(18)式から試料平均の標準偏差を求めよ。

\begin{center}

表1. 針金の直径

\vspace{0.2cm}
\begin{tabular}{|c|c|c|c|c|c|} \hline
直径~[mm] & 1.014 & 1.016 & 1.011 & 1.017 & 1.022  \\  
\hline
\end{tabular}
\end{center}

\newpage

\noindent {\bf [問題8]}~重力加速度を測定するにあたり、おもりのつい
た紐の長さと振動周期をそれぞれ5回ずつ測定した。下表の測定値
について、まず紐の長さと振動周期について解析を行い、最確値、
母集団の標準偏差、試料平均の標準偏差値を求めよ({\bf 6.3}の
{\bf [例]}を参考にすること)。これから(21)、(22)式に基づき、
重力加速度の最確値と母集団の標準偏差および試料平均の標準偏差
を求めよ。

\begin{center}

表2. 紐の長さと振動周期

\vspace{0.2cm}
\begin{tabular}{|c|c|} \hline
$L$~[mm]  \\ \hline
1041      \\ \hline
1042       \\ \hline
1040       \\ \hline
1041       \\ \hline
1043       \\ \hline
\end{tabular}\ \ \ \ \ 
\begin{tabular}{|c|c|} \hline
 $T$~[s] \\ \hline
 2.070    \\ \hline
 2.040    \\ \hline
 2.055    \\ \hline
 2.045    \\ \hline
 2.035    \\ \hline
\end{tabular}
\end{center}


%\newpage

\noindent {\bf [問題9]}~{\bf 問題2}の結果を用いて下表の測定値より$R$と
$V_0$の最確値を求めよ。

\begin{center}

表3. 導線の電流電圧特性

\vspace{0.2cm}
\begin{tabular}{|c|c|} \hline
電流$I$~[mA] & 電圧$V$~[mV] \\ \hline
~99.40   & ~33.82    \\ \hline
198.12   & ~67.56    \\ \hline
301.50   & 102.72    \\ \hline
473.50   & 161.72    \\ \hline
\end{tabular}

\end{center}


\bigskip

\noindent {\bf [問題10]}~下表は極低温(温度$T$)における銅の比熱$C$の測定デー
タである。$y=C/T$、$x=T^2$を計算し、縦軸に$y$、横軸に$x$をとっ
たグラフを方眼紙に描け。比熱を $C=\gamma T + AT^3$と表したと
き、これを$x$と$y$の関係として表し、
$\gamma$と$A$の値を最小二乗法で決定せよ。

\begin{center}

表4. 極低温域における銅の比熱

\vspace{0.2cm}
\begin{tabular}{||c|c||c|c||} \hline
温度$T$~[K] & 比熱$C$~[mJ/mol$\cdot$K] & 温度$T$~[K] & 比 
熱$C$~[mJ/mol$\cdot$K]\\ \hline
4.12   &  6.017  &  3.01  &  3.391 \\ \hline
3.88   &  5.702  &  2.85  &  3.083 \\ \hline
3.80   &  5.148  &  2.45  &  2.479 \\ \hline
3.67   &  4.914  &  2.24  &  2.106 \\ \hline
3.52   &  4.710  &  2.01  &  1.760 \\ \hline
3.33   &  4.021  &  1.73  &  1.396 \\ \hline
3.16   &  3.820  &  1.36  &  1.042 \\ \hline
\end{tabular}

\end{center}

\bigskip

\noindent {\bf [問題11]}~等間隔で目盛ってある方眼紙を用いて$1 \sim 200$
までの片対数グラフを作成せよ。$1 \sim10$および$10 \sim 100$の間隔は
100~[mm]とし、$10 \sim 100$の間を間隔10ごとに目盛れ。

\bigskip

\newpage

\noindent {\bf [問題12]}~{\bf 問題11}で作ったグラフに、下表のデータを書き
入れ、$x$と$y$の関係を示せ。傾きはグラフから求めたものでよく、誤差処理は
行わなくてよい。必ず$y=\cdots$と書くこと。$\log y=\cdots$は不可。

\begin{center}

表5. ある材料の電圧電流特性

\vspace{0.2cm}
\begin{tabular}{||c|c||c|c||} \hline
電圧$x$~[V] & 電流$y$~[A] & 電圧$x$~[V] & 電流$y$~[A] \\  
\hline
0.45   &  ~3.02  &  2.95  &  ~30.2 \\ \hline
1.00   &  ~5.02  &  3.50  &  ~50.2 \\ \hline
1.50   &  ~7.96  &  4.00  &  ~79.6 \\ \hline
1.75   &  10.0~  &  5.00  &  200~  \\ \hline
2.50   &  20.0~  &        &        \\ \hline
\end{tabular}

\end{center}

\bigskip

\noindent {\bf [問題13]}~下表の測定データを市販の両対数グラフに書き入れ、
{\bf 問題12}と同様に$x$と$y$の関係を示せ。傾きはグラフから求めたものでよ
く、誤差処理は行わなくてよい。必ず $y=\cdots$という形で示すこと。

\begin{center}

表6. 時間と距離の関係

\vspace{0.2cm}
\begin{tabular}{||c|c||c|c||} \hline
$x$~[s] & $y$~[m] & $x$~[s] & $y$~[m] \\ \hline
1.0   &  ~4.90  &  ~4.0  &  ~78.4 \\ \hline
2.0   &  19.6~  &  ~5.0  &  122.5 \\ \hline
3.0   &  44.1~  &  10.0  &  490~  \\ \hline
\end{tabular}

\end{center}

\newpage

